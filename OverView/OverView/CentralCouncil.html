<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>داشبورد شورای مرکزی — بنیاد مسکن</title>
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Vazirmatn font -->
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#f7fafc; /* light background */
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#047857;
      --danger:#b91c1c;
      --glass-border: rgba(15,23,42,0.04);
    }
    html,body{height:100%;}
    body { font-family: 'Vazirmatn', Tahoma, Arial, sans-serif; background: var(--bg); color:#0f172a; }
    .glass { background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.95)); box-shadow: 0 6px 18px rgba(14,22,33,0.04); border:1px solid var(--glass-border); }

    .card {
  border-radius: 12px;

  border-top: 5px solid #0d664d;
}


    .avatar { width:64px; height:64px; border-radius:9999px; overflow:hidden; display:inline-block; border:2px solid rgba(0,0,0,0.05); }
    .gauge { width:110px; height:110px; }
    .chip { background:#eef2ff; color:#3730a3; padding:4px 8px; border-radius:999px; font-size:12px; }
    table th, table td{border-collapse:collapse}
    @media (max-width: 768px){ .hide-sm { display:none !important; } }

    .header{
      display:block ruby;align-items:center;justify-content:space-between;
      background:linear-gradient(135deg,#293331,var(--accent));
      padding:24px 30px;
      border-radius:18px;
      color:white;
      box-shadow:0 12px 30px rgba(0,163,137,0.3); 
      position:relative;
      overflow:hidden;
    }


  </style>
</head>
<body class="antialiased">
  <div class="max-w-7xl mx-auto p-6">
    <!-- HEADER -->
      <div class="header">
        <div class="logo">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 19.5v-15a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v15m-4 0v-15a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v15m-4 0v-15a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v15"/>
            <path d="M22 22H2v-2h20z"/>
          </svg>
        </div>
        <div>
              <div class="text-sm font-medium" style="font-weight:bold; font-size:22px; margin-bottom:20px; margin-Right:10px">شورای مرکزی بنیاد مسکن انقلاب اسلامی</div>
              <div class="text-sm font-medium" style="font-weight:bold; font-size:17px; margin-bottom:0px; margin-Right:10px">رصد مصوبات، پیگیری و گزارش مدیریتی</div>

        </div>
      </div>
      <div style="text-align:left; z-index:1">
        <div style="font-size:14px;font-weight:700;margin-bottom:4px">وضعیت سامانه: <span class="kpi">عملیاتی</span></div>
        <div style="font-size:12px;opacity:0.95">به‌روزرسانی: امروز، ساعت ۰۹:۴۵</div>
      </div>


      <!-- Avatars full list -->
      <div class="flex items-center gap-4">

<div class="flex items-center justify-center gap-10 bg-gray-50 p-3 rounded-2xl shadow shadow-gray-300 border border-gray-300" style="margin-bottom:10px; align:center;">

          <!-- member template -->
          <div class="flex items-center gap-3">
            <div class="text-right">
              <div class="text-sm font-medium">حسین روحانی نژاد</div>
              <div class="text-xs text-gray-500">رئیس شورای مرکزی</div>
            </div>
            <div class="avatar">
              <img src="https://bonyadmaskan.github.io/Images/CentralCouncil/RoohaniNezhad.jpg" alt="حسین روحانی نژاد" class="w-full h-full object-cover">
            </div>
          </div>

          <div class="flex items-center gap-3">
            <div class="text-right">
              <div class="text-sm font-medium">محمد سعیدی‌کیا</div>
              <div class="text-xs text-gray-500">عضو شورای مرکزی</div>
            </div>
            <div class="avatar">
              <img src="https://bonyadmaskan.github.io/Images/CentralCouncil/SaeediKia.jpg" alt="محمد سعیدی‌کیا" class="w-full h-full object-cover">
            </div>
          </div>

          <div class="flex items-center gap-3">
            <div class="text-right">
              <div class="text-sm font-medium">فرزانه صادق مالواجرد</div>
              <div class="text-xs text-gray-500">وزیر راه و شهرسازی</div>
            </div>
            <div class="avatar">
              <img src="https://bonyadmaskan.github.io/Images/CentralCouncil/Sadegh.jpg" alt="فرزانه صادق مالواجرد" class="w-full h-full object-cover">
            </div>
          </div>

          <div class="flex items-center gap-3">
            <div class="text-right">
              <div class="text-sm font-medium">منوچهر خواجه‌دلویی</div>
              <div class="text-xs text-gray-500">رئیس بنیاد مسکن</div>
            </div>
            <div class="avatar">
              <img src="https://bonyadmaskan.github.io/Images/CentralCouncil/KhajeDaloei.jpg" alt="منوچهر خواجه‌دلویی" class="w-full h-full object-cover">
            </div>
          </div>


          <div class="flex items-center gap-3">
            <div class="text-right">
              <div class="text-sm font-medium">امیرحسین گرکانی</div>
              <div class="text-xs text-gray-500">عضو شورای مرکزی</div>
            </div>
            <div class="avatar">
              <img src="https://bonyadmaskan.github.io/Images/CentralCouncil/Garakani.jpg" alt="امیرحسین گرکانی" class="w-full h-full object-cover">
            </div>
          </div>

        </div>
      </div>


    <!-- KPI CARDS: larger and light theme -->
    <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 mb-6">
      <div class="glass p-4 card shadow-sm">
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm text-gray-500">تعداد کل مصوبات</div>
            <div class="text-2xl font-bold">1,248</div>
          </div>
          <div class="chip">کل</div>
        </div>
        <div class="text-xs text-gray-400 mt-2">تعداد مصوبات ثبت‌شده در سامانه</div>
      </div>

      <div class="glass p-4 card shadow-sm">
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm text-gray-500">مصوبات اجرا شده</div>
            <div class="text-2xl font-bold text-green-600">912</div>
          </div>
          <div class="chip">اجرا</div>
        </div>
        <div class="text-xs text-gray-400 mt-2">نسبت اجرا به کل</div>
      </div>

      <div class="glass p-4 card shadow-sm">
        <div class="flex items-center justify-between">
          <canvas id="g1" class="gauge"></canvas>
        </div>
        <div class="text-xs text-gray-400 mt-2" style="font-weight:bold; text-align:center; color:#f59e0b">میانگین پیشرفت - 254 <span id="runningAvg">62%</span></div>
      </div>

      <div class="glass p-4 card shadow-sm">
        <div class="flex items-center justify-between">
          <div>
          </div>
<canvas id="g2" class="gauge" style="display: block; box-sizing: border-box; height: 100px; width: 100px;" width="100" height="100"></canvas>
        </div>
        <div class="text-xs text-gray-400 mt-2" style="font-weight:bold; text-align:center; color:#ef4444">مصوبات معوق/بحرانی  82   <span id="runningAvg">15%</span></div>
      </div>

      <div class="glass p-4 card shadow-sm lg:col-span-2">
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm text-gray-500">میانگین تحقق اهداف</div>
            <div class="text-2xl font-bold">78%</div>
          </div>
          <div class="flex items-center gap-3">
<canvas id="g3" class="gauge" style="display: block; box-sizing: border-box; height: 0px; width: 0px;" width="290" height="290"></canvas>

            <div class="text-xs text-gray-400">شاخص عملکرد کل</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Charts row: progress line, status donut, risk polar -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
      <div class="glass p-4 card">
        <h3 class="font-semibold text-lg mb-2">روند پیشرفت مجموعی</h3>
        <canvas id="progressChart" height="300"></canvas>
      </div>

      <div class="glass p-4 card">
        <h3 class="font-semibold text-lg mb-2">توزیع وضعیت مصوبات</h3>
        <canvas id="statusDonut" height="140"></canvas>
      </div>

      <div class="glass p-4 card">
        <h3 class="font-semibold text-lg mb-2">نمای ریسک (Polar)</h3>
        <canvas id="riskPolar" height="140"></canvas>
      </div>
    </section>

    <!-- Breakdown charts (map removed) -->
    <section class="grid grid-cols-1 xl:grid-cols-2 gap-4 mb-6">
      <div class="glass p-4 card xl:col-span-1">
        <h3 class="font-semibold text-lg mb-3">پراکندگی وضعیت بر حسب معاونت (توسعه‌یافته)</h3>
        <div class="h-96">
          <canvas id="byDept" height="200"></canvas>
        </div>
        <div class="mt-3 text-sm text-gray-500">نمودار STACKED برای نمایش وضعیت جاری و معوق هر معاونت — قابل فیلتر به تفکیک سال و استان</div>
      </div>

      <div class="glass p-4 card xl:col-span-1">
        <h3 class="font-semibold text-lg mb-3">بودجه تخصیص‌یافته vs مصرف‌شده (جزئیات)</h3>
        <div class="h-96">
          <canvas id="budgetBar" height="200"></canvas>
        </div>
        <div class="mt-3 text-sm text-gray-500">نمودار ترکیبی (ستونی + خطی) نمایش اختصاص و مصرف به‌تفکیک سال و نوع پروژه</div>
      </div>
    </section>

    <!-- List + Calendar + Documents -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
      <div class="glass p-4 card lg:col-span-2">
        <h3 class="font-semibold text-lg mb-3">لیست مصوبات اخیر</h3>
        <div class="overflow-auto max-h-64">
          <table class="w-full text-sm table-auto">
            <thead class="text-gray-600 text-xs border-b border-gray-200">
              <tr>
                <th class="py-2 text-right pr-3">عنوان</th>
                <th class="py-2 text-left pl-3">معاونت</th>
                <th class="py-2 text-center">وضعیت</th>
                <th class="py-2 text-center">پیشرفت</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
              <tr>
                <td class="py-2 text-right pr-3">بازآفرینی بافت فرسوده — فاز ۱</td>
                <td class="py-2 text-left pl-3">معاونت امور بازسازی</td>
                <td class="py-2 text-center"><span class="text-amber-600">در حال اجرا</span></td>
                <td class="py-2 text-center">65%</td>
              </tr>
              <tr>
                <td class="py-2 text-right pr-3">تسریع ساخت مسکن محرومین</td>
                <td class="py-2 text-left pl-3">بنیادمسکن استان خوزستان</td>
                <td class="py-2 text-center"><span class="text-red-600">معوق</span></td>
                <td class="py-2 text-center">22%</td>
              </tr>
              <tr>
                <td class="py-2 text-right pr-3">تامین اعتبار برای پروژه‌های روستایی</td>
                <td class="py-2 text-left pl-3">معاونت پشتیبانی و توسعه مدیریت</td>
                <td class="py-2 text-center"><span class="text-green-600">انجام شده</span></td>
                <td class="py-2 text-center">100%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="glass p-4 card">
        <h3 class="font-semibold text-lg mb-3">تقویم جلسات</h3>
        <div class="space-y-3 text-sm">
          <div class="p-3 rounded-md bg-white border">۱۴ آذر ۱۴۰۴ — ۱۰:۰۰ — جلسه ویژه پیگیری خوزستان</div>
          <div class="p-3 rounded-md bg-white border">۲۵ آذر ۱۴۰۴ — ۱۴:۰۰ — جلسه ماهانه شورای مرکزی</div>
        </div>

        <div class="mt-4 text-xs text-gray-500">برای افزودن جلسه جدید از فرم داخلی استفاده کنید.</div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="flex flex-col sm:flex-row gap-3 items-center justify-between mt-6">
      <div class="text-sm text-gray-500">نسخه روشن (Light theme) — آماده اتصال به API و داده‌های واقعی</div>
      <div class="flex gap-2">
        <button id="exportPdf" class="px-4 py-2 rounded-md bg-white border">صادر کردن گزارش (PDF)</button>
        <button id="refreshBtn" class="px-4 py-2 rounded-md bg-emerald-600 text-white font-semibold">رفرش داده‌ها</button>
      </div>
    </footer>
  </div>

  <script>
    // Center text plugin for Chart.js (simple)
    const centerTextPlugin = {
      id: 'centerText',
      afterDraw: (chart) => {
        if (chart.config.options.elements && chart.config.options.elements.center) {
          const ctx = chart.ctx;
          const centerConfig = chart.config.options.elements.center;
          const fontStyle = centerConfig.fontStyle || '600';
          const txt = centerConfig.text;
          ctx.save();
          const fontSize = (chart.width / 8).toFixed(0);
          ctx.font = fontStyle + ' ' + fontSize + 'px "Vazirmatn", sans-serif';
          ctx.fillStyle = centerConfig.color || '#000';
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillText(txt, (chart.width / 2), (chart.height / 2));
          ctx.restore();
        }
      }
    };
    Chart.register(centerTextPlugin);

    // Gauges using doughnut charts
    function makeGauge(id, value, color){
      const ctx = document.getElementById(id).getContext('2d');
      return new Chart(ctx, {
        type: 'doughnut',
        data: { datasets:[{ data:[value, 100-value], backgroundColor:[color, '#e6e6e6'], hoverOffset:0 }] },
        options: { cutout:'75%', plugins:{ legend:{display:false}, tooltip:{enabled:false} }, elements:{ center:{ text: value + '%', color:'#111' } } }
      });
    }

    const g1 = makeGauge('g1', 62, '#f59e0b');
    const g2 = makeGauge('g2', 15, '#ef4444');
    const g3 = makeGauge('g3', 78, '#10b981');

    // Progress line chart
    const pCtx = document.getElementById('progressChart').getContext('2d');
    const progressChart = new Chart(pCtx, {
      type:'line',
      data:{ labels:['فروردین','اردیبهشت','خرداد','تیر','مرداد','شهریور','مهر','آبان','آذر'], datasets:[
        { label:'معاونت‌های ستادی', data:[20,30,45,50,55,60,66,70,75], borderColor:'#0ea5a4', backgroundColor:'rgba(14,165,164,0.08)', tension:0.35, fill:true },
        { label:'استان‌ها', data:[10,18,30,38,45,50,56,60,68], borderColor:'#0369a1', backgroundColor:'rgba(3,105,161,0.06)', tension:0.35, fill:true },
        { label:'شرکت‌های تابعه', data:[5,12,20,28,35,40,45,50,58], borderColor:'#7c3aed', backgroundColor:'rgba(124,58,237,0.06)', tension:0.35, fill:true }
      ] },
      options:{ responsive:true, plugins:{ legend:{position:'top'} }, scales:{ x:{ ticks:{color:'#475569'} }, y:{ beginAtZero:true, max:100, ticks:{color:'#475569'} } } }
    });

    // Status donut
    const sCtx = document.getElementById('statusDonut').getContext('2d');
    const statusDonut = new Chart(sCtx, {
      type:'doughnut',
      data:{ labels:['انجام شده','در حال اجرا','معوق','حساس'], datasets:[{ data:[912,254,82,24], backgroundColor:['#10b981','#f59e0b','#ef4444','#ec4899'] }] },
      options:{ cutout:'60%', plugins:{ legend:{ position:'bottom' } }, elements:{ center:{ text:'78%', color:'#111' } } }
    });

    // Risk polar
    const rCtx = document.getElementById('riskPolar').getContext('2d');
    const riskPolar = new Chart(rCtx, {
      type:'polarArea',
      data:{ labels:['خطر مالی','خطر زمانی','خطر اجرایی','خطر حقوقی'], datasets:[{ data:[35,25,20,20], backgroundColor:['#ef4444','#f59e0b','#f97316','#60a5fa'] }] },
      options:{ plugins:{ legend:{ position:'right' } } }
    });

    // By dept bar (horizontal stacked, more detailed)
    const dCtx = document.getElementById('byDept').getContext('2d');
    const byDept = new Chart(dCtx, {
      type:'bar',
      data:{ labels:['معاونت امور مسکن شهری','معاونت پشتیبانی و توسعه مدیریت','معاونت عمران و توسعه روستایی','معاونت امور بازسازی','معاونت برنامه ریزی','شرکتهای تابعه','بنیاد مسکن استانها'], datasets:[
        { label:'انجام شده', data:[60,50,40,70,30,45,55], backgroundColor:'#10b981' },
        { label:'در حال اجرا', data:[25,30,35,20,40,30,25], backgroundColor:'#60a5fa' },
        { label:'معوق', data:[15,20,25,10,30,25,20], backgroundColor:'#ef4444' }
      ] },
      options:{ responsive:true, indexAxis:'y', scales:{ x:{ stacked:true, beginAtZero:true }, y:{ stacked:true } }, plugins:{ legend:{ position:'top' } } }
    });

    // Budget bar (combo: stacked bars + utilization line)
    const bCtx = document.getElementById('budgetBar').getContext('2d');
    const budgetBar = new Chart(bCtx, {
      data:{ labels:['نهضت ملی مسکن','تامین مسکن محرومین	',' اجرای طرح هادی','بازسازی و نوسازی'], datasets:[
        { label:'اختصاص یافته (میلیارد تومان)', type:'bar', data:[420,300,280,200], backgroundColor:'#34d399' },
        { label:'مصرف‌شده (میلیارد تومان)', type:'bar', data:[360,240,200,150], backgroundColor:'#60a5fa' },
        { label:'درصد مصرف', type:'line', data:[85,80,71,75], borderColor:'#f59e0b', backgroundColor:'rgba(245,158,11,0.08)', tension:0.3, yAxisID:'pct' }
      ] },
      options:{ responsive:true, plugins:{ legend:{ position:'top' } }, scales:{ y:{ beginAtZero:true, position:'left', title:{ display:true, text:'میلیارد تومان' } }, pct:{ type:'linear', position:'right', beginAtZero:true, max:100, grid:{ drawOnChartArea:false }, title:{ display:true, text:'درصد مصرف' } } } }
    });

    // Refresh button behaviour
    document.getElementById('refreshBtn').addEventListener('click', (e)=>{
      const btn = e.currentTarget; btn.textContent='در حال بروزرسانی...'; btn.disabled=true;
      setTimeout(()=>{ btn.textContent='رفرش داده‌ها'; btn.disabled=false; },900);
      // simulate small updates
      [progressChart, statusDonut, riskPolar, byDept, budgetBar].forEach(ch=> ch.update());
    });

  </script>
</body>
</html>
