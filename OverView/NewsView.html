<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ูพูู ุงุฌุฑุง ุฑุตุฏ ู ุชุญูู ุฑุณุงููโุง ุจูุงุฏ ูุณฺฉู</title>

    <!-- Vazirmatn font -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

    <style>
        body { font-family: 'Vazirmatn', sans-serif; background-color: #f4f6f9; }
        .card-shadow { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05), 0 4px 6px -2px rgba(0,0,0,0.05); }
        .rtl-text-left { text-align: left; direction: ltr; } /* for numeric alignment if needed */
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-8xl mx-auto space-y-8">

        <!-- Header -->
        <header class="bg-indigo-700 p-6 rounded-3xl card-shadow border-t-8 border-yellow-400">
            <div class="flex flex-col lg:flex-row items-center justify-between gap-4">
                <h1 class="text-3xl font-extrabold text-white flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 ml-3 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM6.293 7.293a1 1 0 011.414 0L10 9.586l2.293-2.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                    ูพูู ุงุฌุฑุง ุฑุตุฏ ู ุชุญูู ุฑุณุงููโุง ุจูุงุฏ ูุณฺฉู
                </h1>

                <div class="flex items-center gap-3">
                    <div class="text-sm text-gray-200 hidden md:block">
                        ๐ ุฏูุฑู ฺฏุฒุงุฑุด: <span id="periodLabel">ูุงูุงูู (ููุฑ)</span> &nbsp; | &nbsp;
                        ๐ฐ๏ธ ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู: <span id="lastUpdate">ฐน:ฐฐ ุตุจุญ</span>
                    </div>

                    <!-- Time filter -->
                    <div class="bg-white rounded-xl p-2 flex items-center gap-2">
                        <label class="text-xs text-gray-600 ml-2">ููุชุฑ ุฒูุงู</label>
                        <select id="timeFilter" class="border rounded-lg px-2 py-1 text-sm" onchange="onTimeFilterChange()">
                            <option value="month" selected>ูุงู</option>
                            <option value="week">ููุชู</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Important analysis banner (user-specified) -->
            <div id="globalAlert" class="mt-4 p-3 rounded-xl bg-yellow-50 border-l-4 border-yellow-500 text-sm text-gray-800">
                <strong>๐ ุชุญูู:</strong> ฺฉุงูุด ุนููฺฉุฑุฏ ูุณุจุช ุจู ูุงู ูุจู ุฏุฑ <strong>ฑฐ ุงุณุชุงู</strong> ูุดุงูุฏู ุดุฏู.
                <br>
                <strong>๐ก ูพุดููุงุฏ ุงูุฏุงู:</strong> ุจุฑุฑุณ ุฏูุงู ุชุฃุฎุฑ ุฏุฑ ุงุณุชุงูโูุง <span class="font-semibold">ุงุตููุงูุ ุฎุฑุงุณุงู ุฌููุจุ ุขุฐุฑุจุงุฌุงู ุดุฑู</span> ู <span class="font-semibold">ฺฉุฑูุงูุดุงู</span>.
            </div>
        </header>

        <!-- Section: KPI Cards -->
        <section class="space-y-6">
            <h2 class="text-2xl font-bold text-indigo-700 border-b-2 border-indigo-300 pb-3">ฑ. ุดุงุฎุตโูุง ุญุงุช ู ูุถุนุช ุจุญุฑุงู</h2>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-6">
                <!-- KPI 1 -->
                <div class="bg-white p-5 rounded-2xl card-shadow border-r-4 border-indigo-500 text-center">
                    <p class="text-sm text-gray-500">ุญุฌู ูพูุดุด ฺฉู</p>
                    <p id="kpi_coverage" class="text-3xl font-extrabold text-indigo-700 mt-1">1,850</p>
                    <div class="mt-3 text-sm text-gray-600" id="kpi_coverage_analysis">
                        ๐ ุชุญูู: ุงูุฒุงุด ุฌุฒุฆ ูุณุจุช ุจู ุฏูุฑู ฺฏุฐุดุชู.
                        <div class="mt-2 text-xs text-indigo-700 font-bold">๐ก ูพุดููุงุฏ: ุชูุฑฺฉุฒ ุจุฑ ุฎุจุฑฺฏุฒุงุฑโูุง ูุญู ุฏุฑ ุฎูุฒุณุชุงู.</div>
                    </div>
                </div>

                <!-- KPI 2 -->
                <div class="bg-white p-5 rounded-2xl card-shadow border-r-4 border-green-500 text-center">
                    <p class="text-sm text-gray-500">ุงุญุณุงุณุงุช ูุซุจุช (ุณูู)</p>
                    <p id="kpi_positive" class="text-3xl font-extrabold text-green-600 mt-1">ถธูช</p>
                    <div class="mt-3 text-sm text-gray-600" id="kpi_positive_analysis">
                        ๐ ุชุญูู: ุงูุช ณูช ูุณุจุช ุจู ูุงู ูุจู.
                        <div class="mt-2 text-xs text-green-700 font-bold">๐ก ูพุดููุงุฏ: ุชููุช ูุญุชูุง ูููู ุฏุฑ ุงูุณุชุงฺฏุฑุงู ู ุจุงุฒูุดุฑ ฺฏุฒุงุฑุดโูุง ุชุญูู ุจูููุน.</div>
                    </div>
                </div>

                <!-- KPI 3 -->
                <div class="bg-white p-5 rounded-2xl card-shadow border-r-4 border-red-500 text-center">
                    <p class="text-sm text-gray-500">ุงุฎุจุงุฑ ุงูุชูุงุฏ ุฌุฏ</p>
                    <p id="kpi_critical" class="text-3xl font-extrabold text-red-600 mt-1">ฑฒฐ</p>
                    <div class="mt-3 text-sm text-gray-600" id="kpi_critical_analysis">
                        ๐ ุชุญูู: ุชูุฑฺฉุฒ ุงูุชูุงุฏุงุช ุฑู ููุถูุน ุชุณููุงุช ู ุชุงุฎุฑ ูพุฑุฏุงุฎุช.
                        <div class="mt-2 text-xs text-red-700 font-bold">๐ก ูพุดููุงุฏ: ุจุงุฒฺฉุฑุฏู ฺฉุงูุงู ูพุงุณุฎฺฏู ุดูุงู ุจุฑุง ุดฺฉุงุงุช ุชุณููุงุช.</div>
                    </div>
                </div>

                <!-- KPI 4 -->
                <div class="bg-white p-5 rounded-2xl card-shadow border-r-4 border-yellow-500 text-center">
                    <p class="text-sm text-gray-500">ุงูุชุงุฒ ฺฉู ุฑุถุงุช (ุงุฒ ฑฐฐ)</p>
                    <p id="kpi_satisfaction" class="text-3xl font-extrabold text-yellow-600 mt-1">ธฒ</p>
                    <div class="mt-3 text-sm text-gray-600" id="kpi_satisfaction_analysis">
                        ๐ ุชุญูู: ุงูุชุงุฒ ูพุงุฏุงุฑ ุงูุง ูุงุฒ ุจู ุชูุฑฺฉุฒ ุจุฑ ุงุณุชุงูโูุง ููู.
                        <div class="mt-2 text-xs text-yellow-700 font-bold">๐ก ูพุดููุงุฏ: ฺฉููพู ุงุทูุงุนโุฑุณุงู ูุญู ุฌูุช ุดูุงูโุณุงุฒ ูพุฑูฺูโูุง.</div>
                    </div>
                </div>

                <!-- KPI 5 -->
                <div class="bg-white p-5 rounded-2xl card-shadow border-r-4 border-purple-500 text-center">
                    <p class="text-sm text-gray-500">ูุฑุฎ ูพุงุณุฎฺฏู ุฑุณู</p>
                    <p id="kpi_response_rate" class="text-3xl font-extrabold text-purple-600 mt-1">ทตูช</p>
                    <div class="mt-3 text-sm text-gray-600" id="kpi_response_analysis">
                        ๐ ุชุญูู: ูุฑุฎ ููุงุณุจ ูู ุจุง ุชุฃุฎุฑ ุฏุฑ ููุงุญ ูพุฑุชูุงุณ.
                        <div class="mt-2 text-xs text-purple-700 font-bold">๐ก ูพุดููุงุฏ: ุชุฎุตุต ุชู ูพุงุณุฎโุฏู ูฺู ุจุฑุง ุงุณุชุงูโูุง ูพุฑุชุฑุงูฺฉ.</div>
                    </div>
                </div>

                <!-- KPI 6 -->
                <div class="bg-white p-5 rounded-2xl card-shadow border-r-4 border-gray-500 text-center">
                    <p class="text-sm text-gray-500">ูุชูุณุท ุฒูุงู ูพุงุณุฎ (ุณุงุนุช)</p>
                    <p id="kpi_avg_time" class="text-3xl font-extrabold text-gray-700 mt-1">ฑด.ต</p>
                    <div class="mt-3 text-sm text-gray-600" id="kpi_time_analysis">
                        ๐ ุชุญูู: ุงูุฒุงุด ูุงูฺฏู ุฒูุงู ูพุงุณุฎ ุจู ุฏูู ูพฺฉ ุชูุงุณ.
                        <div class="mt-2 text-xs text-gray-800 font-bold">๐ก ูพุดููุงุฏ: ุจุงุฒูฺฏุฑ ูุฑุขูุฏ ุซุจุช ู ุงุฑุฌุงุน ุฏุฑุฎูุงุณุชโูุง.</div>
                    </div>
                </div>
            </div>

            <!-- Sentiment Comparison Chart -->
            <div class="bg-white p-6 rounded-2xl card-shadow">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold mb-3">๐ ุฑููุฏ ููุงุณูโุง ุงุญุณุงุณุงุช</h3>
                    <div class="text-sm text-gray-500">ููุงุด: <span id="chartPeriodLabel">ูุงูุงูู</span></div>
                </div>
                <div class="relative h-80">
                    <canvas id="sentimentComparison"></canvas>
                </div>
                <div class="mt-3 text-sm text-gray-600" id="sentimentComparison_analysis">
                    ๐ ุชุญูู: ุฑุดุฏ ูุซุจุช ุฏุฑ ููุชูโูุง ูุงู ูุงูุ ุงูุช ุฏุฑ ูพุงุงู ูุงู. 
                    <div class="mt-2 text-xs text-indigo-700 font-bold">๐ก ูพุดููุงุฏ: ุงูุชุดุงุฑ ูุญุชูุง ูููู ุฏุฑ ุฒูุงู ุงูุฌ ุชุนุงูู (ููุชู ุฏูู).</div>
                </div>
            </div>
        </section>

        <!-- Section 2: Deep Topic Analysis -->
        <section class="space-y-6">
            <h2 class="text-2xl font-bold text-indigo-700 border-b-2 border-indigo-300 pb-3">ฒ. ุชุญูู ุนูู ููุถูุน ู ูุญุฑฺฉโูุง ุงุญุณุงุณุงุช</h2>

            <div class="grid lg:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-2xl card-shadow lg:col-span-2">
                    <h3 class="text-xl font-semibold mb-3">๐ ุณูู ุงุญุณุงุณุงุช ุฏุฑ ูุฑ ุญูุฒู ูุนุงูุช</h3>
                    <div class="relative h-96">
                        <canvas id="sentimentByTopic"></canvas>
                    </div>
                    <div class="mt-3 text-sm text-gray-600" id="sentimentByTopic_analysis">
                        ๐ ุชุญูู: ููุถูุนุงุช ยซุจุงุฒุณุงุฒยป ู ยซุชุณููุงุชยป ุจุดุชุฑู ุณูู ููู ุฑุง ุฏุงุฑูุฏ.
                        <div class="mt-2 text-xs text-indigo-700 font-bold">๐ก ูพุดููุงุฏ: ุชุญูู ุฑุดูโุง ุดฺฉุงุงุช ุชุณููุงุช ู ุชุณุฑุน ุฏุฑ ูพุฑุฏุงุฎุช ูพุฑูฺูโูุง ุจุงุฒุณุงุฒ.</div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl card-shadow flex flex-col justify-between">
                    <div>
                        <h3 class="text-xl font-semibold mb-3">โญ ูุญุฑฺฉโูุง ฺฉูุฏ ุงุญุณุงุณุงุช</h3>
                        <h4 class="font-bold text-green-600 mt-4 mb-2">โ ต ฺฉููู/ุนุจุงุฑุช ุจุง ุจุงุฑ ูุซุจุช ุจุงูุง</h4>
                        <ul class="text-sm space-y-1">
                            <li class="p-2 bg-green-50 rounded-lg">ฑ. ุชุฃูู ุฒูู (ณตฐ ุจุงุฑ)</li>
                            <li class="p-2 bg-green-50 rounded-lg">ฒ. ุชุญูู ุจูููุน (ฒฑฐ ุจุงุฑ)</li>
                            <li class="p-2 bg-green-50 rounded-lg">ณ. ููุงููโุณุงุฒ (ฑธต ุจุงุฑ)</li>
                            <li class="p-2 bg-green-50 rounded-lg">ด. ููฺฉุงุฑ ุงุณุชุงูุฏุงุฑ (ฑถฐ ุจุงุฑ)</li>
                            <li class="p-2 bg-green-50 rounded-lg">ต. ูพุดุฑูุช ูุฒฺฉ (ฑดฐ ุจุงุฑ)</li>
                        </ul>
                    </div>

                    <div class="mt-4">
                        <h4 class="font-bold text-red-600 mb-2">โ๏ธ ต ฺฉููู/ุนุจุงุฑุช ุจุง ุจุงุฑ ููู ุจุงูุง</h4>
                        <ul class="text-sm space-y-1">
                            <li class="p-2 bg-red-50 rounded-lg">ฑ. ุงูุฒุงุด ููุช ูุตุงูุญ (ตฒฐ ุจุงุฑ)</li>
                            <li class="p-2 bg-red-50 rounded-lg">ฒ. ุชุฃุฎุฑ ุฏุฑ ูพุฑุฏุงุฎุช (ดณฐ ุจุงุฑ)</li>
                            <li class="p-2 bg-red-50 rounded-lg">ณ. ุจุฏู ูพูุงูฺฉุงุฑุงู (ฒธฐ ุจุงุฑ)</li>
                            <li class="p-2 bg-red-50 rounded-lg">ด. ุชุณููุงุช ุจุงูฺฉ (ฒดฐ ุจุงุฑ)</li>
                            <li class="p-2 bg-red-50 rounded-lg">ต. ุจูุฑูฺฉุฑุงุณ (ฒฑฐ ุจุงุฑ)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Media Channels & Geography -->
        <section class="space-y-6">
            <h2 class="text-2xl font-bold text-indigo-700 border-b-2 border-indigo-300 pb-3">ณ. ุชุญูู ฺฉุงูุงูโูุง ุฑุณุงููโุง ู ุฌุบุฑุงูุง</h2>

            <div class="grid lg:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-2xl card-shadow flex flex-col justify-center items-center">
                    <h3 class="text-xl font-semibold mb-5 text-center">๐ ุณูู ูพูุดุด ุฑุณุงููโุง ุจุฑ ุงุณุงุณ ฺฉุงูุงู</h3>
                    <div class="relative h-64 w-64">
                        <canvas id="mediaShare"></canvas>
                    </div>
                    <p class="text-sm text-gray-500 mt-4">ุชูุฑฺฉุฒ ุจุดุชุฑ ุจุฑ ุฎุจุฑฺฏุฒุงุฑโูุง ุฏุงุฎู ู ุชูฺฏุฑุงู ุจู ุนููุงู ฺฉุงูุงู ูพุฑุงูุชูุงุฏ</p>
                </div>

                <div class="bg-white p-6 rounded-2xl card-shadow lg:col-span-2">
                    <h3 class="text-xl font-semibold mb-3">๐๏ธ ูุฒุงู ุชุนุงูู ููุงุฏูุง ุงุฌุฑุง (ุชุนุฏุงุฏ ุฎุจุฑ)</h3>
                    <div class="relative h-96">
                        <canvas id="institutionActivity"></canvas>
                    </div>
                    <div class="mt-3 text-sm text-gray-600" id="institutionActivity_analysis">
                        ๐ ุชุญูู: ูุฒุงุฑุช ุฑุงูุ ูุฌูุณ ู ุงุณุชุงูุฏุงุฑโูุง ุจุดุชุฑู ุชุนุงูู ุฎุจุฑ ุฑุง ุฏุงุฑูุฏ.
                        <div class="mt-2 text-xs text-indigo-700 font-bold">๐ก ูพุดููุงุฏ: ููุงููฺฏ ูพุงู ูุงุญุฏ ุจุง ููุงุฏูุง ฺฉูุฏ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงูุชุดุงุฑ ูพุงูโูุง ูุชูุงูุถ.</div>
                    </div>
                </div>
            </div>

            <!-- Regional Hotlist -->
            <div class="bg-white p-6 rounded-2xl card-shadow">
                <h3 class="text-xl font-semibold mb-3">๐ ุงุณุชุงูโูุง ุฏุงุฑุง ุจุงูุงุชุฑู ุญุฌู ูพูุดุด ุฑุณุงููโุง</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 text-center">
                    <div class="p-3 bg-gray-100 rounded-xl border-b-2 border-red-500">
                        <p class="text-sm text-red-700 font-bold">ุฎูุฒุณุชุงู</p>
                        <p class="text-xs text-gray-600">ธฐ ุฎุจุฑ (ถตูช ููู)</p>
                    </div>
                    <div class="p-3 bg-gray-100 rounded-xl border-b-2 border-blue-500">
                        <p class="text-sm text-blue-700 font-bold">ุงุตููุงู</p>
                        <p class="text-xs text-gray-600">ตต ุฎุจุฑ (ถฐูช ููู)</p>
                    </div>
                    <div class="p-3 bg-gray-100 rounded-xl border-b-2 border-orange-500">
                        <p class="text-sm text-orange-700 font-bold">ูุงุฒูุฏุฑุงู</p>
                        <p class="text-xs text-gray-600">ดท ุฎุจุฑ (ตฐูช ุฎูุซ)</p>
                    </div>
                    <div class="p-3 bg-gray-100 rounded-xl border-b-2 border-green-500">
                        <p class="text-sm text-green-700 font-bold">ฺฉุฑูุงูุดุงู</p>
                        <p class="text-xs text-gray-600">ดฒ ุฎุจุฑ (ธตูช ูุซุจุช)</p>
                    </div>
                    <div class="p-3 bg-gray-100 rounded-xl border-b-2 border-red-500">
                        <p class="text-sm text-red-700 font-bold">ุขุฐุฑุจุงุฌุงู ุดุฑู</p>
                        <p class="text-xs text-gray-600">ดต ุฎุจุฑ (ตตูช ููู)</p>
                    </div>
                    <div class="p-3 bg-gray-100 rounded-xl border-b-2 border-blue-500">
                        <p class="text-sm text-blue-700 font-bold">ุชูุฑุงู</p>
                        <p class="text-xs text-gray-600">ถฐ ุฎุจุฑ (ถฐูช ูุซุจุช)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tools & Action Bar -->
        <div class="flex flex-wrap justify-around items-center bg-white p-4 rounded-2xl card-shadow border-t-4 border-indigo-600 mt-8">
            <button class="bg-indigo-600 text-white px-5 py-2 m-2 rounded-xl hover:bg-indigo-700 transition shadow-md flex items-center">
                ฺฏุฒุงุฑุด ููุงุท ููุช
            </button>
            <button class="bg-red-600 text-white px-5 py-2 m-2 rounded-xl hover:bg-red-700 transition shadow-md flex items-center">
                ูุณุช ุงูุชูุงุฏุงุช ุงูููุชโุฏุงุฑ
            </button>
            <button class="bg-green-600 text-white px-5 py-2 m-2 rounded-xl hover:bg-green-700 transition shadow-md flex items-center">
                ุงุฑุณุงู ฺฏุฒุงุฑุด ุจูโุฑูุฒุฑุณุงู
            </button>
        </div>
    </div>

    <!-- JS: data (ูุฑุถ ูุฒุฏฺฉ ุจู ูุงูุนุช) ู ููุทู ููุชุฑ -->
    <script>
        // register plugin
        Chart.register(ChartDataLabels);
        Chart.defaults.font.family = 'Vazirmatn';
        Chart.defaults.font.size = 12;
        Chart.defaults.plugins.legend.rtl = true;
        Chart.defaults.plugins.tooltip.rtl = true;

        // ูุฑุถ: ุฏุงุฏูโูุง ุจุฑุง ุฏู ุญุงูุช month ู week
        const DATA = {
            month: {
                // KPIs
                kpis: {
                    coverage: 1850,
                    positive: 68,
                    critical: 120,
                    satisfaction: 82,
                    responseRate: 75,
                    avgTime: 14.5
                },
                sentimentComparison: {
                    labels: ['ููุชู ฑ','ููุชู ฒ','ููุชู ณ','ููุชู ด'],
                    datasets: [
                        { label: 'ูุซุจุช (ูุงู ุฌุงุฑ)', data: [65,70,68,72], borderColor:'#10b981', backgroundColor:'rgba(16,185,129,0.15)', fill:true, tension:0.3, borderWidth:3 },
                        { label: 'ูุซุจุช (ูุงู ูุจู)', data: [60,65,62,68], borderColor:'#9ca3af', backgroundColor:'rgba(156,163,175,0.08)', fill:false, tension:0.3, borderDash:[6,6] }
                    ]
                },
                sentimentByTopic: {
                    labels: ['ูุณฺฉู ุฑูุณุชุง','ููุถุช ูู ูุณฺฉู','ุจุงุฒุณุงุฒ ุจุญุฑุงู','ุชูุณุนู ุฒุฑุณุงุฎุช','ุชุนุงูู ุจุง ุฏููุช'],
                    datasets: [
                        { label:'ูุซุจุช', data:[55,40,75,60,45], backgroundColor:'#10b981' },
                        { label:'ุฎูุซ', data:[35,30,15,25,35], backgroundColor:'#facc15' },
                        { label:'ููู', data:[10,30,10,15,20], backgroundColor:'#ef4444' }
                    ]
                },
                mediaShare: {
                    labels:['ุฎุจุฑฺฏุฒุงุฑโูุง ุฏุงุฎู','ููุงุฏูุง ุฑุณู','ูุถุง ูุฌุงุฒ','ุฑุณุงููโูุง ุฎุงุฑุฌ'],
                    data:[45,25,28,2]
                },
                institutionActivity: {
                    labels:['ูุฒุงุฑุช ุฑุงู ู ุดูุฑุณุงุฒ','ูุฌูุณ ุดูุฑุง ุงุณูุงู','ุงุณุชุงูุฏุงุฑุงู','ุณุงุฒูุงู ุจุฑูุงูู ู ุจูุฏุฌู','ูุฒุงุฑุช ฺฉุดูุฑ','ุจุงูฺฉ ูุฑฺฉุฒ'],
                    data:[150,120,95,70,60,40]
                }
            },

            week: {
                kpis: {
                    coverage: 520,
                    positive: 70,
                    critical: 30,
                    satisfaction: 84,
                    responseRate: 78,
                    avgTime: 12.2
                },
                sentimentComparison: {
                    labels: ['ุฏูุดูุจู','ฺูุงุฑุดูุจู','ุฌูุนู'],
                    datasets: [
                        { label: 'ูุซุจุช (ููุชู ุฌุงุฑ)', data: [68,71,70], borderColor:'#10b981', backgroundColor:'rgba(16,185,129,0.15)', fill:true, tension:0.3, borderWidth:3 },
                        { label: 'ูุซุจุช (ููุชู ูุจู)', data: [66,69,67], borderColor:'#9ca3af', backgroundColor:'rgba(156,163,175,0.08)', fill:false, tension:0.3, borderDash:[6,6] }
                    ]
                },
                sentimentByTopic: {
                    labels: ['ูุณฺฉู ุฑูุณุชุง','ููุถุช ูู ูุณฺฉู','ุจุงุฒุณุงุฒ ุจุญุฑุงู','ุชูุณุนู ุฒุฑุณุงุฎุช','ุชุนุงูู ุจุง ุฏููุช'],
                    datasets: [
                        { label:'ูุซุจุช', data:[60,42,72,58,48], backgroundColor:'#10b981' },
                        { label:'ุฎูุซ', data:[30,35,18,28,32], backgroundColor:'#facc15' },
                        { label:'ููู', data:[10,23,10,14,20], backgroundColor:'#ef4444' }
                    ]
                },
                mediaShare: {
                    labels:['ุฎุจุฑฺฏุฒุงุฑโูุง ุฏุงุฎู','ููุงุฏูุง ุฑุณู','ูุถุง ูุฌุงุฒ','ุฑุณุงููโูุง ุฎุงุฑุฌ'],
                    data:[48,20,30,2]
                },
                institutionActivity: {
                    labels:['ูุฒุงุฑุช ุฑุงู ู ุดูุฑุณุงุฒ','ูุฌูุณ ุดูุฑุง ุงุณูุงู','ุงุณุชุงูุฏุงุฑุงู','ุณุงุฒูุงู ุจุฑูุงูู ู ุจูุฏุฌู','ูุฒุงุฑุช ฺฉุดูุฑ','ุจุงูฺฉ ูุฑฺฉุฒ'],
                    data:[40,35,30,22,18,12]
                }
            }
        };

        // Chart holders
        let charts = {};

        function createChart(id, config) {
            const ctx = document.getElementById(id).getContext('2d');
            return new Chart(ctx, config);
        }

        // create initial charts (month)
        function initCharts(mode='month') {
            const m = DATA[mode];

            // sentimentComparison (line)
            if (charts.sentimentComparison) charts.sentimentComparison.destroy();
            charts.sentimentComparison = createChart('sentimentComparison', {
                type: 'line',
                data: m.sentimentComparison,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: false, min: 40, max: 100, title: { display: true, text: 'ุฏุฑุตุฏ ุงุญุณุงุณุงุช ูุซุจุช' } } },
                    plugins: { legend: { position: 'bottom' }, datalabels:{display:false} }
                }
            });

            // sentimentByTopic (stacked bar)
            if (charts.sentimentByTopic) charts.sentimentByTopic.destroy();
            charts.sentimentByTopic = createChart('sentimentByTopic', {
                type: 'bar',
                data: m.sentimentByTopic,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x:{ stacked:true }, y:{ stacked:true, beginAtZero:true, max:100, title:{display:true,text:'ุฏุฑุตุฏ ฺฉู ูพูุดุด ููุถูุน'} } },
                    plugins: { legend:{ position:'bottom' } }
                }
            });

            // mediaShare (doughnut)
            if (charts.mediaShare) charts.mediaShare.destroy();
            charts.mediaShare = createChart('mediaShare', {
                type: 'doughnut',
                data: {
                    labels: m.mediaShare.labels,
                    datasets: [{ data: m.mediaShare.data, backgroundColor:['#4f46e5','#a855f7','#f97316','#64748b'] }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position:'bottom' },
                        datalabels: {
                            formatter: (value, ctx) => {
                                let sum = ctx.chart.data.datasets[0].data.reduce((a,b)=>a+b,0);
                                return (value*100/sum).toFixed(1) + '%';
                            },
                            color:'#fff',
                            font:{weight:'600'}
                        }
                    }
                }
            });

            // institutionActivity (horizontal bar)
            if (charts.institutionActivity) charts.institutionActivity.destroy();
            charts.institutionActivity = createChart('institutionActivity', {
                type: 'bar',
                data: {
                    labels: m.institutionActivity.labels,
                    datasets: [{ label:'ุชุนุฏุงุฏ ุฎุจุฑ ูุดุชุฑฺฉ', data: m.institutionActivity.data, backgroundColor:'#4f46e5', borderRadius:8 }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x: { beginAtZero:true, title:{display:true,text:'ุชุนุฏุงุฏ ุฎุจุฑ'} } },
                    plugins: { legend:{ display:false }, datalabels: { anchor: 'end', align: 'end', formatter: (v)=>v } }
                }
            });
        }

        // update KPI DOMs and analyses based on mode
        function updateKPIs(mode='month') {
            const k = DATA[mode].kpis;
            document.getElementById('kpi_coverage').textContent = numberWithCommas(k.coverage);
            document.getElementById('kpi_positive').textContent = k.positive + '%';
            document.getElementById('kpi_critical').textContent = k.critical;
            document.getElementById('kpi_satisfaction').textContent = k.satisfaction;
            document.getElementById('kpi_response_rate').textContent = k.responseRate + '%';
            document.getElementById('kpi_avg_time').textContent = k.avgTime;

            // Simple auto-analysis rules (ูุซุงู ู ูุงุจู ุชูุณุนู)
            document.getElementById('kpi_coverage_analysis').innerHTML = `๐ ุชุญูู: ุญุฌู ูพูุดุด ุฏุฑ ุฏูุฑู ุงูุชุฎุงุจโุดุฏู ุจุฑุงุจุฑ ${numberWithCommas(k.coverage)} ุฎุจุฑ ุงุณุช. <div class="mt-2 text-xs text-indigo-700 font-bold">๐ก ูพุดููุงุฏ: ุชูุฑฺฉุฒ ุจุฑ ุงุณุชุงูโูุง ุจุง ูุฑุฎ ููู ุจุงูุง.</div>`;

            let posTrend = mode === 'month' ? 'ุงูุช ณูช ูุณุจุช ุจู ูุงู ูุจู' : 'ุซุจุงุช ุง ุฑุดุฏ ุฌุฒุฆ';
            document.getElementById('kpi_positive_analysis').innerHTML = `๐ ุชุญูู: ${posTrend}. <div class="mt-2 text-xs text-green-700 font-bold">๐ก ูพุดููุงุฏ: ุชููุช ูุญุชูุง ูุซุจุช ุจุฑ ุจุณุชุฑ ุงูุณุชุงฺฏุฑุงู ู ุจุงุฒูุดุฑ ฺฏุฒุงุฑุดโูุง ูููู.</div>`;

            document.getElementById('kpi_critical_analysis').innerHTML = `๐ ุชุญูู: ุงุฎุจุงุฑ ุงูุชูุงุฏ ุจุงูุบ ุจุฑ ${k.critical} ููุฑุฏ ุซุจุช ุดุฏูโุงูุฏ. <div class="mt-2 text-xs text-red-700 font-bold">๐ก ูพุดููุงุฏ: ุชู ูพุงุณุฎฺฏู ููุฑ ุจุฑุง ููุถูุนุงุช ุชุณููุงุช ุชุดฺฉู ุฏูุฏ.</div>`;

            document.getElementById('kpi_satisfaction_analysis').innerHTML = `๐ ุชุญูู: ุงูุชุงุฒ ุฑุถุงุช ${k.satisfaction} ุงุฒ ฑฐฐ ุซุจุช ุดุฏู ุงุณุช. <div class="mt-2 text-xs text-yellow-700 font-bold">๐ก ูพุดููุงุฏ: ฺฉููพู ุดูุงูโุณุงุฒ ูุญู ุฑุงูโุงูุฏุงุฒ ุดูุฏ.</div>`;

            document.getElementById('kpi_response_analysis').innerHTML = `๐ ุชุญูู: ูุฑุฎ ูพุงุณุฎฺฏู ${k.responseRate}ูช. <div class="mt-2 text-xs text-purple-700 font-bold">๐ก ูพุดููุงุฏ: ุชุฎุตุต ูุฑู ูพุงุณุฎฺฏู ุจุฑ ุงุณุงุณ ุงุณุชุงูโูุง ุฏุงุฑุง ุจุดุชุฑู ุชูุงุณ.</div>`;

            document.getElementById('kpi_time_analysis').innerHTML = `๐ ุชุญูู: ูุชูุณุท ุฒูุงู ูพุงุณุฎ ${k.avgTime} ุณุงุนุช ุงุณุช. <div class="mt-2 text-xs text-gray-800 font-bold">๐ก ูพุดููุงุฏ: ุจุงุฒูฺฏุฑ ูุฑุงูุฏ ุงุฑุฌุงุน ุฏุฑุฎูุงุณุชโูุง ู ุงูููุชโุจูุฏ ููุงุฑุฏ ุจุญุฑุงู.</div>`;
        }

        // number format
        function numberWithCommas(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // on time filter change
        function onTimeFilterChange() {
            const mode = document.getElementById('timeFilter').value;
            document.getElementById('periodLabel').textContent = mode === 'month' ? 'ูุงูุงูู (ุดูุฑูุฑ)' : 'ููุชฺฏ (ููุชู ุฌุงุฑ)';
            document.getElementById('chartPeriodLabel').textContent = mode === 'month' ? 'ูุงูุงูู' : 'ููุชฺฏ';
            initCharts(mode);
            updateKPIs(mode);

            // update global alert logic (example: if month and many negatives)
            if (mode === 'month') {
                document.getElementById('globalAlert').innerHTML = '<strong>๐ ุชุญูู:</strong> ฺฉุงูุด ุนููฺฉุฑุฏ ูุณุจุช ุจู ูุงู ูุจู ุฏุฑ <strong>ฑฐ ุงุณุชุงู</strong> ูุดุงูุฏู ุดุฏู.<br><strong>๐ก ูพุดููุงุฏ ุงูุฏุงู:</strong> ุจุฑุฑุณ ุฏูุงู ุชุฃุฎุฑ ุฏุฑ ุงุณุชุงูโูุง <span class="font-semibold">ุงุตููุงูุ ุฎุฑุงุณุงู ุฌููุจุ ุขุฐุฑุจุงุฌุงู ุดุฑู</span> ู <span class="font-semibold">ฺฉุฑูุงูุดุงู</span>.';
                document.getElementById('globalAlert').className = 'mt-4 p-3 rounded-xl bg-yellow-50 border-l-4 border-yellow-500 text-sm text-gray-800';
            } else {
                document.getElementById('globalAlert').innerHTML = '<strong>๐ ุชุญูู:</strong> ูุถุนุช ููุชู ุฌุงุฑ ูุณุจุชุงู ุจุงุซุจุงุช ุงุณุชุ ุจุฑุฎ ุงุณุชุงูโูุง ุนูุงุฆู ููุณุงู ูุดุงู ูโุฏููุฏ.<br><strong>๐ก ูพุดููุงุฏ ุงูุฏุงู:</strong> ุฑุตุฏ ุฑูุฒุงูู ู ูพุงุณุฎ ุณุฑุน ุจู ููุถูุนุงุช ุชุณููุงุช ุฏุฑ ุงุณุชุงูโูุง ูพุฑุชุนุงูู.';
                document.getElementById('globalAlert').className = 'mt-4 p-3 rounded-xl bg-blue-50 border-l-4 border-blue-500 text-sm text-gray-800';
            }
        }

        // init
        document.addEventListener('DOMContentLoaded', function(){
            initCharts('month');
            updateKPIs('month');
        });
    </script>
</body>
</html>
